
----------------- COMPONENTS ------------------
Service -> é a alternativa do IP de cada POD do k8s, para evitar que tenha que configurar manualmente. Os services se comunicam. Possuem IP permanente. É um loadbalancer (distribui "cargas" de trabalho entre os nodes)

-Comunicação Externa
Ingress -> faz o forwarding para o Service, ao invés de usar o external

-Configuração
ConfigMap -> configuração externa da aplicação
Secret -> semelhante ao ConfigMap, mas para armazenar dados sensíveis, base64 encoded

-Armazenamento
Volumes -> para persistir as informações do Pod (principalmente nos DBs). Pode ser armazenado localmente (dentro do Node) ou remotamente (fora do Node).

-Criação de Pods
Deployment -> um blueprint para criação de "my-app" pods. Possível de escalar com as replicas. Abstração dos pods. Stateless.
StatefulSet -> focado em databases. Deve ser usado para criar database, ao invés do Deployment. Stateful.

----------------- ARCHITECTURE ------------------
Tem que ter em cada Worker node:
1 - Kubelet
2 - Kube Proxy
3 - Container runtime

Master:
1 - API server
2 - Scheduler
3 - Controller manager
4 - etcd

---------------- MINIKUBE --------------------
Master e Worker rodam em um único node.
Cria uma Virtual Box no pc.

---------------- KUBECTL INSTALLATION ------------------
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256"
echo "$(cat kubectl.sha256)  kubectl" | sha256sum --check
sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
kubectl version --client

kubectl get nodes
kubectl get pods
kubectl get services (mostra IP do cluster e IP externo)
kubectl get deployments
kubectl get replicaset
kubectl logs <nome-pod>
kubectl describe <nome-pod>
kubectl exec -it <nome-pod> -- bin/bash (entrar no database)
kubectl describe service <nome-service>
kubectl get pods -o wide (mais informações)

----------------- YAML FILE ------------------
Três partes:
1) metadata
2) specification
3) status (automático do etcd)

O "template" dentro de "spec" no Deployment é aplicado ao Pod !!!!!!
selector e matchLabels cria a conexão. 
containerPort (deployment) deve bater com o targetPort (service)


echo -n 'username' | base64 (comando para codificar em base64 para arquivo secret)

A ORDEM IMPORTA NA CRIAÇÃO: primeiro o secret e configmap, depois o deployment.

É possível colocar o service e o deployment no mesmo arquivo .yml

O "nodeport" precisa estar entre 30000-32767 no caso do LoadBalancer (para External Service)

kubectl get services (mostra IP do cluster e IP externo)
minikube service <nome-service-comunicacao-externa> cria um IP externo












